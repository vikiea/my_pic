# 团队管理接口设计文档
## 功能流程梳理
### 分成信息展示流程
#### 取数据逻辑
- 默认分成
    - 一级KA登录
        - 全部成员
            条件
            - ka_id=一级kaId,ka_type=kaType,target_id=0
        - 全部二级KA
            条件
            - ka_id=一级kaId,ka_type=kaType,type=0,target_id=0
        - 全部推广员
            条件
            - ka_id=一级kaId,ka_type=kaType,type=1,target_id=0
    - 二级KA登录
        - 全部推广员
            条件
            - ka_id=二级kaId,ka_type=kaType,type=1,target_id=0
            - ka_id=一级kaId,ka_type=kaType,type=1,target_id=0
            
            > 如果一级KA条件有值，则该值被隐藏
- 自定义分成
    - 一级KA登录
        - 自定义二级KA
            条件(优先级递增)
            - ka_id=一级kaId,type=0,target_id=0 
            - ka_id=一级KaId,type=0,target_id=targetId
        - 自定义推广员
            - 一级KA直属推广员
                条件(优先级递增)
                - ka_id=一级kaId,type=1,target_id=0 
                - ka_id=一级KaId,type=1,target_id=targetId
            - 一级KA下二级KA的推广员
                条件(优先级递增)
                - ka_id=二级kaId,type=1,target_id=0 
                - ka_id=二级KaId,type=1,target_id=targetId
                - ka_id=一级kaId,type=1,target_id=0 
                - ka_id=一级KaId,type=1,target_id=targetId
    - 二级KA登录
        - 二层KA归属
            条件(优先级递增)
            - ka_id=二级kaId,type=1,target_id=0 
            - ka_id=二级KaId,type=1,target_id=targetId
            - ka_id=一级kaId,type=1,target_id=0 
            - ka_id=一级KaId,type=1,target_id=targetId
           
            > 如果一级KA条件有值，则该值被隐藏
        - 直属于一级KA
            条件(优先级递增)
            - ka_id=二级kaId,type=1,target_id=0 
            - ka_id=二级KaId,type=1,target_id=targetId

#### 数据补全逻辑
##### 获取可设置分成范围
 - 一级KA登录：
    - 默认分成：
        - 全部成员默认
            - 取KA最小单价作为范围上限maxPrice
            - 下限为0
        - 二级KA默认
            - 已设置推广员分成
                - 固定金额
                    - minPrice
                        - 条件(优先级递增)
                            - 二级KA已设置推广员分成
                                - ka_type=2,laxin_type=laxinType,type=1,proportion_type=0 
                            
                             > 取其中最大值作为最小值minPrice
                            
                            - 一级KA已设置推广员分成
                                - ka_id=一级KAId,laxin_type=laxinType,type=1,leader_id<>二级KAId,proportion_type=0
                            
                             > 取其中最大值作为最小值minPrice
                                    
                        > 条件覆盖
                        最小比值为minPrice/maxPrice*100%
                    - maxPrice
                        - KA单价最小值
                - 比值
                    -  不需判断
            - 未设置推广员分成
                - 以一级KA单价为maxPrice
                - 0为minPrice
        - 推广员默认
            - 二级KA已设置
                - 固定金额
                    - 以二级KA最小金额作为最大金额
                - 比值
                    - 以二级KA最小比值与KA最小单价的乘积作为最大金额
            
            > 两者取最小值作为最大金额maxPrice,若都为0，则取KA单价最小值
            
            - 二级KA未设置
                - 固定金额
                    - 以KA最小单价为最大值
                - 比值
                    - 100%
    - 自定义分成
        - 自定义推广员
            同默认
        - 自定义二级KA
            同默认